<!DOCTYPE html>
<html>
<head>
    <title>WebSocket Test</title>
</head>
<body>
    <h1>WebSocket Connection Test</h1>
    <div id="status">–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...</div>
    <div id="messages"></div>

    <script>
        const statusDiv = document.getElementById('status');
        const messagesDiv = document.getElementById('messages');

        console.log('–ü–æ–ø—ã—Ç–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ ws://localhost:8080');
        const ws = new WebSocket('ws://localhost:8080');

        ws.onopen = () => {
            console.log('‚úÖ WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω!');
            statusDiv.textContent = '‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–æ!';
            statusDiv.style.color = 'green';

            // –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é
            ws.send(JSON.stringify({
                type: 'register',
                payload: {
                    userId: 'test_user_123',
                    userName: 'Test User'
                }
            }));
        };

        ws.onmessage = (event) => {
            console.log('üì® –ü–æ–ª—É—á–µ–Ω–æ:', event.data);
            const msg = document.createElement('div');
            msg.textContent = `üì® ${event.data}`;
            messagesDiv.appendChild(msg);
        };

        ws.onerror = (error) => {
            console.error('‚ùå –û—à–∏–±–∫–∞:', error);
            statusDiv.textContent = '‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è';
            statusDiv.style.color = 'red';
        };

        ws.onclose = (event) => {
            console.log('‚ùå –û—Ç–∫–ª—é—á–µ–Ω–æ. –ö–æ–¥:', event.code, '–ü—Ä–∏—á–∏–Ω–∞:', event.reason);
            statusDiv.textContent = `‚ùå –û—Ç–∫–ª—é—á–µ–Ω–æ (–∫–æ–¥: ${event.code})`;
            statusDiv.style.color = 'orange';
        };
    </script>
</body>
</html>
